{
  "metadata": {
    "title": "BMC Bolsa Comisionista - Complete Architecture",
    "project_name": "bmc_input",
    "diagram_type": "network",
    "version": "1.0.0",
    "description": "Sistema Regulatorio BMC - 60M productos, 10K facturas/hora",
    "tags": [
      "bmc",
      "regulatorio",
      "dian",
      "colombia",
      "aws"
    ]
  },
  "canvas": {
    "width": 3000,
    "height": 2000,
    "grid_size": 10,
    "background": "white"
  },
  "architecture": {
    "components": [
      {
        "id": "bmc_users",
        "type": "users",
        "label": "BMC Users\\n10K Concurrent\\nRegulatory System",
        "position": {
          "x": 100,
          "y": 150
        },
        "size": {
          "width": 100,
          "height": 80
        },
        "metadata": {
          "capacity": "10000 concurrent users",
          "type": "regulatory_users",
          "region": "Colombia"
        }
      },
      {
        "id": "internet",
        "type": "internet_gateway",
        "label": "Internet\\nHTTPS/TLS 1.3",
        "position": {
          "x": 300,
          "y": 150
        },
        "size": {
          "width": 80,
          "height": 80
        }
      }
    ],
    "containers": [
      {
        "id": "aws_cloud",
        "type": "vpc",
        "label": "AWS Cloud - us-east-1\\nBMC Production Environment",
        "bounds": {
          "x": 50,
          "y": 300,
          "width": 2800,
          "height": 1600
        },
        "children": [
          {
            "id": "edge_security",
            "type": "security_group",
            "label": "Edge & Security Layer",
            "bounds": {
              "x": 100,
              "y": 100,
              "width": 2600,
              "height": 200
            },
            "components": [
              {
                "id": "cloudfront",
                "type": "cloudfront",
                "label": "CloudFront CDN\\nGlobal Edge\\nSSL Termination",
                "position": {
                  "x": 100,
                  "y": 80
                },
                "size": {
                  "width": 120,
                  "height": 100
                }
              },
              {
                "id": "waf",
                "type": "waf",
                "label": "AWS WAF\\nDDoS Protection\\nRate Limiting",
                "position": {
                  "x": 300,
                  "y": 80
                },
                "size": {
                  "width": 120,
                  "height": 100
                }
              },
              {
                "id": "api_gateway",
                "type": "api_gateway",
                "label": "API Gateway\\nREST + GraphQL\\n10K req/sec",
                "position": {
                  "x": 500,
                  "y": 80
                },
                "size": {
                  "width": 120,
                  "height": 100
                },
                "properties": {
                  "throttle_rate": "10000/sec",
                  "burst_limit": "5000"
                }
              },
              {
                "id": "cognito",
                "type": "cognito",
                "label": "Cognito\\nUser Pool\\nMFA Enabled",
                "position": {
                  "x": 700,
                  "y": 80
                },
                "size": {
                  "width": 120,
                  "height": 100
                }
              }
            ]
          },
          {
            "id": "vpc_main",
            "type": "vpc",
            "label": "VPC 10.0.0.0/16\\nBMC Production Network",
            "bounds": {
              "x": 100,
              "y": 350,
              "width": 2600,
              "height": 1200
            },
            "properties": {
              "cidr": "10.0.0.0/16",
              "dns_hostnames": true,
              "flow_logs": true
            },
            "children": [
              {
                "id": "az_a",
                "type": "availability_zone",
                "label": "AZ us-east-1a - Primary",
                "bounds": {
                  "x": 50,
                  "y": 50,
                  "width": 1200,
                  "height": 1100
                },
                "children": [
                  {
                    "id": "public_a",
                    "type": "subnet",
                    "label": "Public Subnet A\\n10.0.1.0/24",
                    "bounds": {
                      "x": 50,
                      "y": 50,
                      "width": 500,
                      "height": 200
                    },
                    "components": [
                      {
                        "id": "alb",
                        "type": "elb",
                        "label": "Application LB\\nMulti-AZ\\nSSL Termination",
                        "position": {
                          "x": 100,
                          "y": 80
                        },
                        "size": {
                          "width": 120,
                          "height": 80
                        }
                      },
                      {
                        "id": "nat_a",
                        "type": "nat_gateway",
                        "label": "NAT Gateway A\\n45 Gbps",
                        "position": {
                          "x": 300,
                          "y": 80
                        },
                        "size": {
                          "width": 100,
                          "height": 80
                        }
                      }
                    ]
                  },
                  {
                    "id": "private_a",
                    "type": "subnet",
                    "label": "Private Subnet A\\n10.0.10.0/24\\nMicroservices Layer",
                    "bounds": {
                      "x": 50,
                      "y": 300,
                      "width": 1100,
                      "height": 400
                    },
                    "components": [
                      {
                        "id": "invoice_service",
                        "type": "fargate",
                        "label": "Invoice Service\\nECS Fargate\\n10K facturas/hora",
                        "position": {
                          "x": 50,
                          "y": 80
                        },
                        "size": {
                          "width": 150,
                          "height": 100
                        },
                        "properties": {
                          "cpu": "4 vCPU",
                          "memory": "8 GB",
                          "replicas": 5,
                          "business_function": "Procesamiento facturas individual y lotes"
                        }
                      },
                      {
                        "id": "product_service",
                        "type": "fargate",
                        "label": "Product Service\\nECS Fargate\\n60M productos",
                        "position": {
                          "x": 250,
                          "y": 80
                        },
                        "size": {
                          "width": 150,
                          "height": 100
                        },
                        "properties": {
                          "cpu": "2 vCPU",
                          "memory": "4 GB",
                          "replicas": 3,
                          "business_function": "Gestión 60M productos migrados GCP"
                        }
                      },
                      {
                        "id": "ocr_service",
                        "type": "fargate",
                        "label": "OCR Service\\nECS Fargate\\n95% precisión",
                        "position": {
                          "x": 450,
                          "y": 80
                        },
                        "size": {
                          "width": 150,
                          "height": 100
                        },
                        "properties": {
                          "cpu": "8 vCPU",
                          "memory": "16 GB",
                          "replicas": 2,
                          "business_function": "Análisis facturas PDF/imagen"
                        }
                      },
                      {
                        "id": "commission_service",
                        "type": "fargate",
                        "label": "Commission Service\\nECS Fargate\\nDIAN Compliance",
                        "position": {
                          "x": 650,
                          "y": 80
                        },
                        "size": {
                          "width": 150,
                          "height": 100
                        },
                        "properties": {
                          "cpu": "4 vCPU",
                          "memory": "8 GB",
                          "replicas": 3,
                          "business_function": "Cálculos comisión regulatoria"
                        }
                      },
                      {
                        "id": "certificate_service",
                        "type": "fargate",
                        "label": "Certificate Service\\nECS Fargate\\nPDF Generation",
                        "position": {
                          "x": 850,
                          "y": 80
                        },
                        "size": {
                          "width": 150,
                          "height": 100
                        },
                        "properties": {
                          "cpu": "2 vCPU",
                          "memory": "4 GB",
                          "replicas": 2,
                          "business_function": "Certificados PDF DIAN compliance"
                        }
                      }
                    ]
                  },
                  {
                    "id": "isolated_a",
                    "type": "subnet",
                    "label": "Isolated Subnet A\\n10.0.20.0/24\\nDatabase Layer",
                    "bounds": {
                      "x": 50,
                      "y": 750,
                      "width": 1100,
                      "height": 300
                    },
                    "components": [
                      {
                        "id": "rds_primary",
                        "type": "rds",
                        "label": "RDS PostgreSQL\\nPrimary Instance\\n60M productos\\ndb.r5.2xlarge",
                        "position": {
                          "x": 100,
                          "y": 100
                        },
                        "size": {
                          "width": 200,
                          "height": 120
                        },
                        "properties": {
                          "engine": "postgresql",
                          "version": "13.7",
                          "instance_class": "db.r5.2xlarge",
                          "storage": "2TB",
                          "multi_az": true,
                          "backup_retention": "7 days"
                        }
                      },
                      {
                        "id": "elasticache",
                        "type": "elasticache",
                        "label": "ElastiCache Redis\\nSession Store\\ncache.r6g.large",
                        "position": {
                          "x": 400,
                          "y": 100
                        },
                        "size": {
                          "width": 180,
                          "height": 120
                        },
                        "properties": {
                          "engine": "redis",
                          "node_type": "cache.r6g.large",
                          "num_nodes": 3
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "id": "az_b",
                "type": "availability_zone",
                "label": "AZ us-east-1b - Secondary",
                "bounds": {
                  "x": 1300,
                  "y": 50,
                  "width": 1200,
                  "height": 1100
                },
                "components": [
                  {
                    "id": "rds_standby",
                    "type": "rds",
                    "label": "RDS PostgreSQL\\nStandby Instance\\nRead Replica\\nus-east-1b",
                    "position": {
                      "x": 100,
                      "y": 800
                    },
                    "size": {
                      "width": 200,
                      "height": 120
                    },
                    "properties": {
                      "engine": "postgresql",
                      "instance_class": "db.r5.2xlarge",
                      "read_replica": true
                    }
                  }
                ]
              }
            ]
          },
          {
            "id": "storage_layer",
            "type": "cluster",
            "label": "Storage & Integration Layer",
            "bounds": {
              "x": 100,
              "y": 1600,
              "width": 2600,
              "height": 250
            },
            "components": [
              {
                "id": "s3_documents",
                "type": "s3",
                "label": "S3 Documents\\nPDFs & Certificates\\n10TB Storage",
                "position": {
                  "x": 100,
                  "y": 80
                },
                "size": {
                  "width": 150,
                  "height": 120
                },
                "properties": {
                  "storage_class": "STANDARD",
                  "versioning": true,
                  "encryption": "AES256"
                }
              },
              {
                "id": "s3_data_lake",
                "type": "s3",
                "label": "S3 Data Lake\\n60M Productos\\nAnalytics",
                "position": {
                  "x": 300,
                  "y": 80
                },
                "size": {
                  "width": 150,
                  "height": 120
                }
              },
              {
                "id": "sqs_queue",
                "type": "sqs",
                "label": "SQS Queue\\nAsync Processing\\nBatch Jobs",
                "position": {
                  "x": 500,
                  "y": 80
                },
                "size": {
                  "width": 150,
                  "height": 120
                }
              },
              {
                "id": "sns_notifications",
                "type": "sns",
                "label": "SNS\\nEmail Notifications\\nCertificate Delivery",
                "position": {
                  "x": 700,
                  "y": 80
                },
                "size": {
                  "width": 150,
                  "height": 120
                }
              }
            ]
          }
        ]
      }
    ],
    "connections": [
      {
        "id": "users_internet",
        "from": "bmc_users",
        "to": "internet",
        "label": "HTTPS",
        "type": "https"
      },
      {
        "id": "internet_cloudfront",
        "from": "internet",
        "to": "cloudfront",
        "label": "Global CDN",
        "type": "https"
      },
      {
        "id": "cloudfront_waf",
        "from": "cloudfront",
        "to": "waf",
        "label": "Security Filter",
        "type": "https"
      },
      {
        "id": "waf_api",
        "from": "waf",
        "to": "api_gateway",
        "label": "Filtered Traffic",
        "type": "https"
      },
      {
        "id": "api_cognito",
        "from": "api_gateway",
        "to": "cognito",
        "label": "Authentication",
        "type": "api"
      },
      {
        "id": "api_alb",
        "from": "api_gateway",
        "to": "alb",
        "label": "Load Balance",
        "type": "https"
      },
      {
        "id": "alb_invoice",
        "from": "alb",
        "to": "invoice_service",
        "label": "Invoice Processing",
        "type": "http"
      },
      {
        "id": "alb_product",
        "from": "alb",
        "to": "product_service",
        "label": "Product Queries",
        "type": "http"
      },
      {
        "id": "alb_ocr",
        "from": "alb",
        "to": "ocr_service",
        "label": "OCR Analysis",
        "type": "http"
      },
      {
        "id": "alb_commission",
        "from": "alb",
        "to": "commission_service",
        "label": "Commission Calc",
        "type": "http"
      },
      {
        "id": "alb_certificate",
        "from": "alb",
        "to": "certificate_service",
        "label": "PDF Generation",
        "type": "http"
      },
      {
        "id": "invoice_db",
        "from": "invoice_service",
        "to": "rds_primary",
        "label": "Invoice Data",
        "type": "sql"
      },
      {
        "id": "product_db",
        "from": "product_service",
        "to": "rds_primary",
        "label": "Product Queries\\n60M records",
        "type": "sql"
      },
      {
        "id": "ocr_db",
        "from": "ocr_service",
        "to": "rds_primary",
        "label": "OCR Results",
        "type": "sql"
      },
      {
        "id": "commission_db",
        "from": "commission_service",
        "to": "rds_primary",
        "label": "Commission Data",
        "type": "sql"
      },
      {
        "id": "product_cache",
        "from": "product_service",
        "to": "elasticache",
        "label": "Product Cache",
        "type": "nosql"
      },
      {
        "id": "invoice_cache",
        "from": "invoice_service",
        "to": "elasticache",
        "label": "Session Cache",
        "type": "nosql"
      },
      {
        "id": "certificate_s3",
        "from": "certificate_service",
        "to": "s3_documents",
        "label": "PDF Storage",
        "type": "api"
      },
      {
        "id": "ocr_s3",
        "from": "ocr_service",
        "to": "s3_documents",
        "label": "Document Upload",
        "type": "api"
      },
      {
        "id": "product_datalake",
        "from": "product_service",
        "to": "s3_data_lake",
        "label": "Analytics Data",
        "type": "data_flow"
      },
      {
        "id": "invoice_queue",
        "from": "invoice_service",
        "to": "sqs_queue",
        "label": "Batch Processing",
        "type": "message_queue"
      },
      {
        "id": "certificate_sns",
        "from": "certificate_service",
        "to": "sns_notifications",
        "label": "Email Delivery",
        "type": "message_queue"
      },
      {
        "id": "db_replication",
        "from": "rds_primary",
        "to": "rds_standby",
        "label": "DB Replication",
        "type": "sql"
      }
    ]
  },
  "output": {
    "formats": [
      "png",
      "drawio"
    ],
    "auto_layout": false,
    "theme": "aws"
  }
}