{
  "drawio_architecture": {
    "metadata": {
      "title": "BMC_INPUT - AWS Architecture",
      "subtitle": "BMC Bolsa Comisionista - 60M Products, 10K Invoices/hour",
      "canvas": {
        "width": 3200,
        "height": 2400,
        "grid": 10,
        "background": "white"
      }
    },
    "layers": [
      {
        "id": "external",
        "name": "External Layer",
        "position": { "x": 50, "y": 100 },
        "components": [
          {
            "id": "users",
            "type": "aws4.users",
            "label": "BMC Users\n10K Concurrent\nWeb + Mobile\nColombia",
            "position": { "x": 100, "y": 120 },
            "size": { "width": 90, "height": 90 },
            "style": {
              "fillColor": "#4CAF50",
              "strokeColor": "#2E7D32",
              "fontSize": 11,
              "fontStyle": 1
            }
          },
          {
            "id": "internet",
            "type": "aws4.internet_gateway",
            "label": "Internet\nHTTPS/TLS 1.3\nGlobal CDN\nLatency < 50ms",
            "position": { "x": 350, "y": 120 },
            "size": { "width": 90, "height": 90 },
            "style": {
              "fillColor": "#0D47A1",
              "strokeColor": "#0277BD",
              "gradientColor": "#1976D2",
              "fontSize": 11
            }
          }
        ]
      },
      {
        "id": "aws_cloud",
        "name": "AWS Cloud",
        "type": "container",
        "label": "AWS Cloud - us-east-1 (N. Virginia)\nProduction Environment - 99.99% SLA",
        "position": { "x": 50, "y": 250 },
        "size": { "width": 2700, "height": 1800 },
        "style": {
          "fillColor": "#E3F2FD",
          "strokeColor": "#1976D2",
          "strokeWidth": 3,
          "dashed": true,
          "fontSize": 14,
          "fontStyle": 1
        },
        "children": [
          {
            "id": "edge_layer",
            "name": "Edge & CDN Layer",
            "type": "container",
            "label": "Edge & CDN Layer\nGlobal Distribution - 200+ Edge Locations",
            "position": { "x": 100, "y": 80 },
            "size": { "width": 800, "height": 200 },
            "style": {
              "fillColor": "#FFEBEE",
              "strokeColor": "#F44336",
              "strokeWidth": 2,
              "fontSize": 12
            },
            "components": [
              {
                "id": "cloudfront",
                "type": "aws4.cloudfront",
                "label": "CloudFront CDN\nGlobal Edge Caching\nSSL/TLS Termination\nGZIP Compression\nCache TTL: 24h",
                "position": { "x": 50, "y": 80 },
                "size": { "width": 100, "height": 100 },
                "metrics": {
                  "requests_per_second": "50K",
                  "cache_hit_ratio": "85%",
                  "edge_locations": "200+"
                }
              },
              {
                "id": "waf",
                "type": "aws4.waf",
                "label": "AWS WAF\nDDoS Protection\nSQL Injection Block\nXSS Prevention\nRate Limiting: 1000/min",
                "position": { "x": 200, "y": 80 },
                "size": { "width": 100, "height": 100 },
                "security": {
                  "rules": ["SQL_INJECTION", "XSS", "RATE_LIMIT"],
                  "rate_limit": "1000/min"
                }
              },
              {
                "id": "route53",
                "type": "aws4.route_53",
                "label": "Route 53\nDNS Management\nHealth Checks\nFailover Routing\nLatency-based",
                "position": { "x": 350, "y": 80 },
                "size": { "width": 100, "height": 100 }
              }
            ]
          },
          {
            "id": "vpc",
            "name": "VPC",
            "type": "container",
            "label": "VPC 10.0.0.0/16\nBMC Production Environment\nDHCP Options Set\nFlow Logs Enabled",
            "position": { "x": 100, "y": 320 },
            "size": { "width": 2400, "height": 1400 },
            "network": {
              "cidr": "10.0.0.0/16",
              "dns_hostnames": true,
              "dns_resolution": true,
              "flow_logs": true
            },
            "children": [
              {
                "id": "az_a",
                "name": "Availability Zone A",
                "type": "availability_zone",
                "label": "Availability Zone us-east-1a\nPrimary AZ - Active\nLatency: < 1ms intra-AZ",
                "position": { "x": 50, "y": 80 },
                "size": { "width": 1100, "height": 1200 },
                "subnets": [
                  {
                    "id": "public_a",
                    "type": "public_subnet",
                    "label": "Public Subnet\n10.0.1.0/24\nInternet Gateway Access",
                    "cidr": "10.0.1.0/24",
                    "position": { "x": 50, "y": 80 },
                    "size": { "width": 400, "height": 200 },
                    "components": [
                      {
                        "id": "nat_a",
                        "type": "aws4.elastic_load_balancing",
                        "label": "NAT Gateway 1A\nOutbound Internet\nElastic IP\nBandwidth: 45 Gbps",
                        "position": { "x": 50, "y": 80 },
                        "capacity": "45_gbps"
                      },
                      {
                        "id": "alb",
                        "type": "aws4.elastic_load_balancing",
                        "label": "Application LB\nMulti-AZ\nSSL Termination\nHealth Checks",
                        "position": { "x": 200, "y": 80 }
                      }
                    ]
                  },
                  {
                    "id": "private_a",
                    "type": "private_subnet",
                    "label": "Private Subnet\n10.0.10.0/24\nApplication Layer",
                    "cidr": "10.0.10.0/24",
                    "position": { "x": 50, "y": 300 },
                    "size": { "width": 400, "height": 300 },
                    "components": [
                      {
                        "id": "api_gateway",
                        "type": "aws4.api_gateway",
                        "label": "API Gateway\nREST + GraphQL\nRate Limiting\nAPI Keys\nThrottling: 10K/sec",
                        "position": { "x": 50, "y": 80 },
                        "api_config": {
                          "throttle_rate": "10000/sec",
                          "burst_limit": "5000"
                        }
                      },
                      {
                        "id": "fargate_cert",
                        "type": "aws4.fargate",
                        "label": "Certificate Service\nECS Fargate\nPDF Generation\nDIAN Compliance\nCPU: 2 vCPU, RAM: 4GB",
                        "position": { "x": 200, "y": 80 },
                        "resources": {
                          "cpu": "2_vcpu",
                          "memory": "4_gb",
                          "replicas": 3
                        }
                      },
                      {
                        "id": "cognito",
                        "type": "aws4.cognito",
                        "label": "Cognito\nUser Pool\nAuthentication\nMFA Enabled\n10K Users",
                        "position": { "x": 50, "y": 180 }
                      }
                    ]
                  },
                  {
                    "id": "isolated_a",
                    "type": "isolated_subnet",
                    "label": "Isolated Subnet\n10.0.20.0/24\nDatabase Layer\nNo Internet Access",
                    "cidr": "10.0.20.0/24",
                    "position": { "x": 50, "y": 650 },
                    "size": { "width": 400, "height": 300 },
                    "components": [
                      {
                        "id": "rds_primary",
                        "type": "aws4.rds",
                        "label": "RDS PostgreSQL\nPrimary Instance\nus-east-1a\nMulti-AZ\ndb.r5.2xlarge\n60M Products",
                        "position": { "x": 50, "y": 80 },
                        "database": {
                          "engine": "postgresql",
                          "version": "13.7",
                          "instance_class": "db.r5.2xlarge",
                          "storage": "1TB_gp3",
                          "backup_retention": "7_days"
                        }
                      },
                      {
                        "id": "elasticache",
                        "type": "aws4.elasticache",
                        "label": "ElastiCache\nRedis Cluster\nSession Store\ncache.r6g.large\n16GB Memory",
                        "position": { "x": 200, "y": 80 },
                        "cache": {
                          "engine": "redis",
                          "node_type": "cache.r6g.large",
                          "num_nodes": 3,
                          "memory": "16_gb"
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "id": "az_b",
                "name": "Availability Zone B",
                "type": "availability_zone",
                "label": "Availability Zone us-east-1b\nSecondary AZ - Standby\nCross-AZ Latency: < 2ms",
                "position": { "x": 1200, "y": 80 },
                "size": { "width": 1100, "height": 1200 },
                "components": [
                  {
                    "id": "rds_standby",
                    "type": "aws4.rds",
                    "label": "RDS PostgreSQL\nStandby Instance\nus-east-1b\nRead Replica\nAutomatic Failover",
                    "position": { "x": 100, "y": 800 }
                  }
                ]
              }
            ]
          },
          {
            "id": "s3_storage",
            "type": "aws4.s3",
            "label": "S3 Storage\nDocuments & Assets\nVersioning Enabled\n60M Products Data\n10TB Storage",
            "position": { "x": 2300, "y": 600 },
            "size": { "width": 150, "height": 150 },
            "storage": {
              "size": "10_tb",
              "versioning": true,
              "encryption": "AES256"
            }
          }
        ]
      }
    ],
    "connections": [
      {
        "from": "users",
        "to": "internet",
        "style": {
          "strokeColor": "#232F3E",
          "strokeWidth": 3,
          "endArrow": "classic"
        },
        "label": "HTTPS"
      },
      {
        "from": "internet",
        "to": "cloudfront",
        "style": {
          "strokeColor": "#1976D2",
          "strokeWidth": 3
        },
        "label": "Global CDN"
      },
      {
        "from": "cloudfront",
        "to": "waf",
        "style": {
          "strokeColor": "#F44336",
          "strokeWidth": 2
        },
        "label": "Security Filter"
      },
      {
        "from": "waf",
        "to": "api_gateway",
        "style": {
          "strokeColor": "#5A30B5",
          "strokeWidth": 2
        }
      },
      {
        "from": "api_gateway",
        "to": "cognito",
        "style": {
          "strokeColor": "#DD344C",
          "strokeWidth": 2
        },
        "label": "Auth"
      },
      {
        "from": "api_gateway",
        "to": "alb",
        "style": {
          "strokeColor": "#8C4FFF",
          "strokeWidth": 2
        }
      },
      {
        "from": "alb",
        "to": "fargate_cert",
        "style": {
          "strokeColor": "#D05C17",
          "strokeWidth": 2
        }
      },
      {
        "from": "fargate_cert",
        "to": "rds_primary",
        "style": {
          "strokeColor": "#116D5B",
          "strokeWidth": 2
        },
        "label": "DB Queries"
      },
      {
        "from": "fargate_cert",
        "to": "elasticache",
        "style": {
          "strokeColor": "#C925D1",
          "strokeWidth": 2
        },
        "label": "Cache"
      },
      {
        "from": "fargate_cert",
        "to": "s3_storage",
        "style": {
          "strokeColor": "#277116",
          "strokeWidth": 2
        },
        "label": "File Storage"
      },
      {
        "from": "rds_primary",
        "to": "rds_standby",
        "style": {
          "strokeColor": "#FF9800",
          "strokeWidth": 2,
          "dashed": true
        },
        "label": "Replication"
      }
    ]
  }
}
